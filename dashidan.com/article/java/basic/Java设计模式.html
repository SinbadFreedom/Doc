<!doctype html>
<html class="no-js" lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Java设计模式</title>
    <meta name="description" content="Java设计模式">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">

    <link rel="stylesheet" href="http://dashidan.com/css/bootstrap.css">
    <link rel="stylesheet" href="http://dashidan.com/css/dashidan.css">
</head>
<body>
<!--[if lte IE 9]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience and security.</p>
<![endif]-->

<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">
                <img src="http://dashidan.com/img/dsd24.png">
            </a>
            <a class="navbar-brand" href="http://dashidan.com/index.html">大屎蛋教程网</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://dashidan.com/about.html">关于</a></li>
                <li><a href="http://dashidan.com/thanks.html">鸣谢</a></li>
                <li><a href="http://dashidan.com/comment.html">评论</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <!-- 顶部面包屑导航-->
    <ol class="breadcrumb">
        <li><a href="http://dashidan.com/index.html"><b>首页</b></a></li>
        <li class="active"><a href="http://dashidan.com/article/java/index.html"><b>Java教程</b></a></li>
    </ol>
    <hr>
    <div id="xs_index" class="col-sm-3 col-md-3 col-lg-3 col-xs-12 hidden-xs">
        <!-- 索引-->
        <div id="xs_index_close" class="text-right visible-xs" onclick="hideIndex()">
            关闭❎
            <hr>
        </div>
        <div>
            <div class="dsd_title">
                <h2>Java从入门到精通</h2>
            </div>
            <div class="dsd_catalog">
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java教程概述.html">📖 1.Java教程概述</a>
                </div>
                <hr>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/搭建Java开发环境.html">📖 2.搭建Java开发环境</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/第一个Java程序.html">📖 3.第一个Java程序</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java代码注释.html">📖 4.Java代码注释</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java变量.html">📖 5.Java变量</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java集成开发环境.html">📖 6.Java集成开发环境</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java运算符.html">📖 7.Java运算符</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java方法.html">📖 8.Java方法</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java流程控制.html">📖 9.Java流程控制</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java命名空间.html">📖 10.Java命名空间</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java数组.html">📖 11.Java数组</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java静态变量与常量.html">📖 12.Java静态变量与常量</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java对象.html">📖 13.Java对象</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java包装类.html">📖 14.Java包装类</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java集合类.html">📖 15.Java集合类</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java异常.html">📖 16.Java异常</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java位运算.html">📖 17.Java位运算</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java转义字符.html">📖 18.Java转义字符</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java线程.html">📖 19.Java线程</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java设计模式.html">📖 20.Java设计模式</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/Java编码优化.html">📖 21.Java编码优化</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/basic/jvm参数优化.html">📖 22.jvm参数优化</a>
                </div>
            </div>
            <div class="dsd_title">
                <h2>附录</h2>
            </div>
            <div class="dsd_catalog">
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/addenda/Java中@Override标签作用.html">📖 Java中@Override标签作用</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/addenda/Java编码规范.html">📖 Java编码规范</a>
                    <hr>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/java/addenda/Java保留关键字.html">📖 Java保留关键字</a>
                </div>
            </div>
        </div>
    </div>
    <div id="sx_index_button" class="visible-xs-block" onclick="showIndex()">
        <!-- 小屏显示目录-->
        <div id="sx_index_button_text">
            <span style="color: white">🔖目录</span>
        </div>
    </div>
    <div id="xs_content">
        <div class="col-sm-9 col-md-9 col-lg-9">
            <!-- 文章内容-->
            <div id="xs_content_border">
                <div>
                    <div class="dsd_title"><h1>20.Java设计模式</h1></div>
                    <div class="dsd_catalog"><a href="#①">① 设计模式简介</a>
                        <hr>
                        <a href="#②">② 单例模式</a>
                        <hr>
                        <a href="#③">③ 工厂模式</a>
                        <hr>
                        <a href="#④">④ 观察者模式</a>
                        <hr>
                        <a href="#⑤">⑤ 相关文章</a></div>
                </div>
                <div class="jumbotron">
                    <p>软件设计领域的四位世界级大师Gang Of Four (GoF):Erich Gamma, Richard Helm, Ralph Johnson,John
                        Vlissides合著了一本非常著名的书《Design Patterns - Elements of Reusable Object-Oriented
                        Software》翻译的中文名为《设计模式:可复用面向对象软件的基础》.书中提出了23种基本设计模式,从理论高度提炼并规范了设计模式,对面向对象软件设计产生了巨大影响.
                    </p>
                </div>
                <p><img class="center-block img-responsive" src="http://dashidan.com/img/java/basic/19-1.jpg"
                        alt="图19-1"/></p>
                <div class="dsd_title"><a href="#top" id="①">① 设计模式简介🔝</a></div>
                <p>总体来说设计模式分为三大类:
                    创建型模式,共五种:工厂模式、抽象工厂模式、单例模式、建造者模式、原型模式.
                    结构型模式,共七种:适配器模式、装饰器模式、代理模式、外观模式、桥接模式、组合模式、享元模式.
                    行为型模式,共十一种:策略模式、模板方法模式、观察者模式、迭代子模式、责任链模式、命令模式、备忘录模式、状态模式、访问者模式、中介者模式、解释器模式.</p>
                <p>有些设计模式我个人认为,不是很具象, 就像星座一样抽象概念居多,导致应用场景不明确. 所以不希望他们占用我过多的脑容量和时间.只挑选几个含金量高, 模型具象, 应用场景广泛的模式来介绍.
                    以下这几个都是非常值得花时间去熟悉的模式.</p>
                <div class="dsd_title"><a href="#top" id="②">② 单例模式🔝</a></div>
                <p>单例模式即是只产生一个对象的模式.在Java中，每次使用<code>new</code>关键字, 就会产生一个新的对象. 有时我们需要只有一个对象产生, 比如一些管理类, 全局管理其它模块时,
                    这个管理类适合采用单例模式.</p>
                <p>普通的单例模式分为2种, 懒汉式和饿汉式.懒汉式比较懒, 用到的时候才创建对象, 饿汉式不讲理, 你用不用我都创建好放着. </p>
                <p><img class="center-block img-responsive" src="http://dashidan.com/img/common/secret.jpg"
                        alt="降龙十八掌秘籍"/></p>
                <p>普通单例模式的秘籍:</p>
                <ul>
                    <li>将构造函数定义为私有<code>private</code>, 只能在本类中创建, 不能被继承.</li>
                    <li>通过<code>private</code>和<code>static</code>关键字定义一个私有并且静态的本类实例对象, 保证内存中只有1个实例, 并且只有本类能调用.</li>
                    <li>公开一个获得本类实例的静态方法, 来获取这个实例, 保证每次得到的实例都是同一个, 来实现单例模式.</li>
                </ul>
                <p>列出4种常用的单例模式的写法, 推荐第4种. 第4种是通过内部类实现, 高效且线程安全. 记住这个好了, 其他的可以忘.</p>
                <h3>1.懒汉式</h3>
                <pre class="prettyprint"><code class="java language-java">/**
 * 懒汉式单例模式
 */
class Singleton1 {

    private static Singleton1 singleton1;

    private Singleton1() {

    }

    public static Singleton1 getInstance() {
        if (null == singleton1) {
            singleton1 = new Singleton1();
        }
        return singleton1;
    }
}
</code></pre>
                <h3>2.饿汉式</h3>
                <pre class="prettyprint"><code class="java language-java">/**
 * 饿汉式单例模式
 */
class Singleton2 {

    private static Singleton2 singleton2 = new Singleton2();

    private Singleton2() {
    }

    public static Singleton2 getInstance() {
        return singleton2;
    }
}
</code></pre>
                <h3>3.线程安全的懒汉式</h3>
                <pre class="prettyprint"><code class="java language-java">/**
 * 线程安全懒汉式单例模式
 */
class Singleton3 {

    private static Singleton3 singleton3;

    private Singleton3() {

    }

    public static synchronized Singleton3 getInstance() {
        if (null == singleton3) {
            singleton3 = new Singleton3();
        }
        return singleton3;
    }
}
</code></pre>
                <h3>4.内部类线程安全单例模式</h3>
                <p>这种方式利用java的<code>final</code>关键字特性, 一旦赋值无法改变.线程安全,效率高推荐方式.</p>
                <pre class="prettyprint"><code class="java language-java">/**
 * 内部类线程安全单例模式
 */
class Singleton4 {

    private static class SingletonHolder {
        public final static Singleton4 instance = new Singleton4();
    }

    public static Singleton4 getInstance() {
        return SingletonHolder.instance;
    }
}
</code></pre>
                <div class="dsd_title"><a href="#top" id="③">③ 工厂模式🔝</a></div>
                <p>工厂模式本质是通过条件语句,根据不同的条件创建不同的对象.通常情况下, 产生的对象继承自同一个父类, 工厂类提供的方法返回的类型为父类对象类型.达到对象封装的作用.</p>
                <p>代码示例:</p>
                <pre class="prettyprint"><code class="java language-java">package com.dashidan.lesson19;

/**
 * 大屎蛋教程网-dashidan.com
 * &lt;p&gt;
 * Java教程基础篇:  19.Java设计模式
 * 工厂模式
 */
public class Demo2 {
    public static void main(String[] args) {
        /** 传入需要生产的产品类型*/
        Product product = Factory.getProduct(1);
        /** 打印产品信息*/
        product.info();
    }
}

/**
 * 工厂模式
 * 根据不同的类型，生产不同的产品
 */
class Factory {
    public static Product getProduct(int type) {
        switch (type) {
            case 1:
                return new Product1();
            case 2:
                return new Product2();
        }
        return null;
    }
}

/**
 * 产品的父类是抽象类，提供一个info方法
 */
abstract class Product {

    public abstract void info();
}

/**
 * 产品Product1继承自父类Product
 */
class Product1 extends Product {
    @Override
    public void info() {
        System.out.println("Product1 info.");
    }
}

/**
 * 产品Product2继承自父类Product
 */
class Product2 extends Product {
    @Override
    public void info() {
        System.out.println("Product2 info.");
    }
}
</code></pre>
                <p>输出:</p>
                <pre><code>Product1 info.
</code></pre>
                <div class="dsd_title"><a href="#top" id="④">④ 观察者模式🔝</a></div>
                <p>观察者模式(也称为发布(publish)-订阅(Subscribe)模式、模型-视图(View)模式、源-收听者(Listener)模式或从属者模式).是一个非常棒的降低代码耦合度的方式.</p>
                <p><img class="center-block img-responsive" src="http://dashidan.com/img/common/secret.jpg"
                        alt="降龙十八掌秘籍"/></p>
                <p>观察者模式的秘籍:</p>
                <ul>
                    <li>观察者在发布者对象上注册消息侦听, 加入消息侦听列表</li>
                    <li>发布者遍历消息侦听列表, 调用观察者方法处理消息</li>
                    <li>不同的观察者对象通常继承同一个观察者接口, 通过接口方法统一处理</li>
                </ul>
                <p>通常用在一对多或者多对多的场景中, 一个对象数据变化了, 需要通知其他对象的场景. 比如<code>ActionScript3</code>语言底层的事件冒泡机制, 就是采用观察者模式设计.</p>
                <p>代码示例:</p>
                <pre class="prettyprint"><code class="java language-java">package com.dashidan.lesson19;


import java.util.ArrayList;

/**
 * 大屎蛋教程网-dashidan.com
 * &lt;p&gt;
 * Java教程基础篇:  19.Java设计模式
 * 观察者模式
 */
public class Demo3 {
    public static void main(String[] args) {
        /** 初始化发布者和观察者*/
        Publisher publisher = new Publisher();
        Observer1 observer1 = new Observer1();
        Observer2 observer2 = new Observer2();
        /** 加入2个观察者到发布者的消息侦听队列*/
        publisher.addObserver(observer1);
        publisher.addObserver(observer2);
        /** 通知观察者*/
        publisher.notifyAllObserver();
    }
}

/**
 * 发布者
 */
class Publisher {

    /**
     * 发布者的消息侦听队列
     */
    ArrayList&lt;IObserver&gt; observers = new ArrayList&lt;&gt;();

    /**
     * 加入消息侦听队列
     */
    public void addObserver(IObserver iObserver) {
        System.out.println("加入观察者");
        observers.add(iObserver);
    }

    /**
     * 通知侦听队列中所有的观察者
     */
    public void notifyAllObserver() {
        for (IObserver iObserver : observers) {
            System.out.println("通知观察者");
            iObserver.action();
        }
    }
}

/**
 * 观察者接口
 */
interface IObserver {
    void action();
}

/**
 * 观察者Observer1类
 */
class Observer1 implements IObserver {
    @Override
    public void action() {
        System.out.println("Observer1 action.");
    }
}

/**
 * 观察者Observer2类
 */
class Observer2 implements IObserver {
    @Override
    public void action() {
        System.out.println("Observer2 action.");
    }
}
</code></pre>
                <p>输出:</p>
                <pre><code>加入观察者
加入观察者
通知观察者
Observer1 action.
通知观察者
Observer2 action.
</code></pre>
                <div class="dsd_title"><a href="#top" id="⑤">⑤ 相关文章🔝</a></div>
                <p>📖 <a href="http://dashidan.com/article/java/basic/index.html">Java从入门到精通目录</a></p>
                <p>📖 <a href="http://dashidan.com/article/java/basic/Java集成开发环境.html">Java集成开发环境</a></p>
                <span>🌟最新内容会在源站更新.转载请保留原文链接🌟: <a href="http://dashidan.com/article/java/index.html">http://dashidan.com/article/java
                    /index.html</a>
                </span>
            </div>
        </div>
    </div>
    <!-- 底部面包屑导航-->
    <ol class="breadcrumb">
        <li><a href="http://dashidan.com/index.html"><b>首页</b></a></li>
        <li><a href="http://dashidan.com/article/java/index.html"><b>Java教程</b></a></li>
    </ol>
    <hr>
    <div class="text-center">
        <div>
            <a href="http://dashidan.com/article/java/basic/Java编码优化.html">📖
                下一篇: Java编码优化</a>
        </div>
    </div>
</div>

<div style="display:none;">
    <script src="https://s19.cnzz.com/z_stat.php?id=1264355070&web_id=1264355070" language="JavaScript"></script>
</div>

<script src="http://dashidan.com/js/jquery-3.2.1.min.js"></script>
<script src="http://dashidan.com/js/vendor/modernizr-custom.js"></script>
<script src="http://dashidan.com/js/bootstrap.js"></script>
<script src="http://dashidan.com/js/google-code-prettify/run_prettify.js"></script>
<script src="http://dashidan.com/js/main.js"></script>
</body>
</html>
