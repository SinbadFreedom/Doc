<!doctype html>
<html class="no-js" lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>æ ‡å‡†åº“æµè§ˆII</title>
    <meta name="description" content="æ ‡å‡†åº“æµè§ˆII">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">

    <link rel="stylesheet" href="http://dashidan.com/css/bootstrap.css">
    <link rel="stylesheet" href="http://dashidan.com/css/dashidan.css">
</head>
<body>

<!--[if lte IE 9]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience and security.</p>
<![endif]-->

<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">
                <img src="http://dashidan.com/img/dsd24.png">
            </a>
            <a class="navbar-brand" href="http://dashidan.com/index.html">å¤§å±è›‹æ•™ç¨‹ç½‘</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://dashidan.com/about.html">å…³äº</a></li>
                <li><a href="http://dashidan.com/thanks.html">é¸£è°¢</a></li>
                <li><a href="http://dashidan.com/siteMap.html">ç½‘ç«™åœ°å›¾</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <!-- é¡¶éƒ¨é¢åŒ…å±‘å¯¼èˆª-->
    <ol class="breadcrumb">
        <li><a href="http://dashidan.com/index.html">é¦–é¡µ</a></li>
        <li class="active"><a href="http://dashidan.com/article/python/index.html">Python</a></li>
    </ol>
    <div id="xs_index" class="col-sm-3 col-md-3 col-lg-3 col-xs-12 hidden-xs">
        <!--
        <div id="xs_index_close" class="text-right visible-xs" onclick="hideIndex()">
            å…³é—­â
            <hr>
        </div>
		-->
        <div>
            <div class="dsd_title" onclick="clickTitle('doc27')">
                <h3><span id="doc27_title">â• Pythonä¸­æ–‡æ–‡æ¡£2.7</span></h3>
            </div>
            <div id="doc27" class="dsd_catalog_left_hide">
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/1.html">1.å‰è¨€</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/2.html">2.è§£é‡Šå™¨</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/3.html">3.ç®€ä»‹</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/4.html">4.æµç¨‹æ§åˆ¶</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/5.html">5.æ•°æ®ç»“æ„</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/6.html">6.æ¨¡å—</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/7.html">7.è¾“å…¥å’Œè¾“å‡º</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/8.html">8.é”™è¯¯</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/9.html">9.ç±»</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/10.html">10.æ ‡å‡†åº“æ¦‚è§ˆ</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/11.html">11.æ ‡å‡†åº“æµè§ˆII</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/12.html">12.æ¥ä¸‹æ¥</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/13.html">13.äº¤äº’å¼è¾“å…¥</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/14.html">14.æµ®ç‚¹æ•°ç®—æ³•</a>
                </div>
                <div class="single_line">
                    <a href="http://dashidan.com/article/python/doc27/15.html">15.é™„å½•</a>
                </div>
            </div>

        </div>
    </div>
    <div id="sx_index_button" class="visible-xs-block" onclick="showIndex()">
        <!-- å°å±æ˜¾ç¤ºç›®å½•-->
        <div id="sx_index_button_text">
            <span style="color: white">ğŸ”–ç›®å½•</span>
        </div>
    </div>
    <div class="col-sm-9 col-md-9 col-lg-9">
        <!-- æ–‡ç« å†…å®¹-->
        <div class="dsd_title"><h1>æ ‡å‡†åº“æµè§ˆII</h1></div>

        <div id="xs_content_border">
            <div>
                <div class="dsd_catalog"><a href="#1">1 è¾“å‡ºæ ¼å¼</a><br><a href="#2">2 æ¨¡æ¿</a><br><a href="#3">3
                    ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®è®°å½•å¸ƒå±€</a><br><a href="#4">4 å¤šçº¿ç¨‹</a><br><a href="#5">5 æ—¥å¿—</a><br><a href="#6">6 å¼±å¼•ç”¨</a><br><a
                    href="#7">7 åˆ—è¡¨å·¥å…·</a><br><a href="#8">8 åè¿›åˆ¶æµ®ç‚¹æ•°ç®—æ³•</a><br></div>
            </div>
            <p>ï»¿ç¬¬äºŒéƒ¨åˆ†åŒ…å«äº†æ”¯æŒä¸“ä¸šç¼–ç¨‹å·¥ä½œæ‰€éœ€çš„æ›´é«˜çº§çš„æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¾ˆå°‘å‡ºç°åœ¨å°è„šæœ¬ä¸­ã€‚</p>
            <div class="dsd_title_1"><a href="#top" id="1"><h2>1 è¾“å‡ºæ ¼å¼</h2></a></div>
            <p><code>repr &lt;https://docs.python.org/2.7/library/functions.html#repr&gt;</code>_ æ¨¡å—ä¸ºå¤§å‹çš„æˆ–æ·±åº¦åµŒå¥—çš„å®¹å™¨ç¼©å†™æ˜¾ç¤ºæä¾›äº†
                <code>repr() &lt;https://docs.python.org/2.7/library/functions.html#repr&gt;</code>_ å‡½æ•°çš„ä¸€ä¸ªå®šåˆ¶ç‰ˆæœ¬::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import repr
&gt;&gt;&gt; repr.repr(set('supercalifragilisticexpialidocious'))
"set(['a', 'c', 'd', 'e', 'f', 'g', ...])"
</code></pre>
            <p><code>pprint &lt;https://docs.python.org/2.7/library/pprint.html#module-pprint&gt;</code>_
                æ¨¡å—ç»™è€æ‰‹æä¾›äº†ä¸€ç§è§£é‡Šå™¨å¯è¯»çš„æ–¹å¼æ·±å…¥æ§åˆ¶å†…ç½®å’Œç”¨æˆ·è‡ªå®šä¹‰å¯¹è±¡çš„æ‰“å°ã€‚å½“è¾“å‡ºè¶…è¿‡ä¸€è¡Œçš„æ—¶å€™ï¼Œâ€œç¾åŒ–æ‰“å°(pretty printer)â€æ·»åŠ æ–­è¡Œå’Œæ ‡è¯†ç¬¦ï¼Œä½¿å¾—æ•°æ®ç»“æ„æ˜¾ç¤ºçš„æ›´æ¸…æ™°::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import pprint
&gt;&gt;&gt; t = [[[['black', 'cyan'], 'white', ['green', 'red']], [['magenta',
...     'yellow'], 'blue']]]
...
&gt;&gt;&gt; pprint.pprint(t, width=30)
[[[['black', 'cyan'],
  'white',
  ['green', 'red']],
 [['magenta', 'yellow'],
  'blue']]]
</code></pre>
            <p><code>textwrap &lt;https://docs.python.org/2.7/library/textwrap.html#module-textwrap&gt;</code>_
                æ¨¡å—æ ¼å¼åŒ–æ–‡æœ¬æ®µè½ä»¥é€‚åº”è®¾å®šçš„å±å®½::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import textwrap
&gt;&gt;&gt; doc = """The wrap() method is just like fill() except that it returns
... a list of strings instead of one big string with newlines to separate
... the wrapped lines."""
...
&gt;&gt;&gt; print textwrap.fill(doc, width=40)
The wrap() method is just like fill()
except that it returns a list of strings
instead of one big string with newlines
to separate the wrapped lines.
</code></pre>
            <p><code>locale &lt;https://docs.python.org/2.7/library/locale.html#module-locale&gt;</code>_
                æ¨¡å—æŒ‰è®¿é—®é¢„å®šå¥½çš„å›½å®¶ä¿¡æ¯æ•°æ®åº“ã€‚locale çš„æ ¼å¼åŒ–å‡½æ•°å±æ€§é›†æä¾›äº†ä¸€ä¸ªç›´æ¥æ–¹å¼ä»¥åˆ†ç»„æ ‡ç¤ºæ ¼å¼åŒ–æ•°å­—::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import locale
&gt;&gt;&gt; locale.setlocale(locale.LC_ALL, 'English_United States.1252')
'English_United States.1252'
&gt;&gt;&gt; conv = locale.localeconv()          # get a mapping of conventions
&gt;&gt;&gt; x = 1234567.8
&gt;&gt;&gt; locale.format("%d", x, grouping=True)
'1,234,567'
&gt;&gt;&gt; locale.format_string("%s%.*f", (conv['currency_symbol'],
...                      conv['frac_digits'], x), grouping=True)
'$1,234,567.80'
</code></pre>
            <div class="dsd_title_1"><a href="#top" id="2"><h2>2 æ¨¡æ¿</h2></a></div>
            <p><code>string &lt;https://docs.python.org/2.7/library/string.html#module-string&gt;</code>_ æä¾›äº†ä¸€ä¸ªçµæ´»å¤šå˜çš„æ¨¡ç‰ˆç±»
                <code>Template &lt;https://docs.python.org/2.7/library/string.html#string.Template&gt;</code>_
                ï¼Œä½¿ç”¨å®ƒæœ€ç»ˆç”¨æˆ·å¯ä»¥ç®€å•åœ°è¿›è¡Œç¼–è¾‘ã€‚è¿™ä½¿ç”¨æˆ·å¯ä»¥åœ¨ä¸è¿›è¡Œæ”¹å˜çš„æƒ…å†µä¸‹å®šåˆ¶ä»–ä»¬çš„åº”ç”¨ç¨‹åºã€‚ </p>
            <p>æ ¼å¼ä½¿ç”¨ <code>$</code> ä¸ºå¼€å¤´çš„ Python åˆæ³•æ ‡è¯†(æ•°å­—ã€å­—æ¯å’Œä¸‹åˆ’çº¿)ä½œä¸ºå ä½ç¬¦ã€‚å ä½ç¬¦å¤–é¢çš„å¤§æ‹¬å·ä½¿å®ƒå¯ä»¥å’Œå…¶å®ƒçš„å­—ç¬¦ä¸åŠ ç©ºæ ¼æ··åœ¨ä¸€èµ·ã€‚<code>$$</code> åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„
                <code>$</code>::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; from string import Template
&gt;&gt;&gt; t = Template('${village}folk send $$10 to $cause.')
&gt;&gt;&gt; t.substitute(village='Nottingham', cause='the ditch fund')
'Nottinghamfolk send $10 to the ditch fund.'
</code></pre>
            <p>å½“ä¸€ä¸ªå ä½ç¬¦åœ¨å­—å…¸æˆ–å…³é”®å­—å‚æ•°ä¸­æ²¡æœ‰è¢«æä¾›æ—¶ï¼Œ<code>substitute() &lt;https://docs.python.org/2.7/library/string.html#string.Template.substitute&gt;</code>_
                æ–¹æ³•å°±ä¼šæŠ›å‡ºä¸€ä¸ª <code>KeyError
                    &lt;https://docs.python.org/2.7/library/exceptions.html#exceptions.KeyError&gt;</code>_
                å¼‚å¸¸ã€‚å¯¹äºé‚®ä»¶åˆå¹¶é£æ ¼çš„åº”ç”¨ç¨‹åºï¼Œç”¨æˆ·æä¾›çš„æ•°æ®å¯èƒ½å¹¶ä¸å®Œæ•´ï¼Œè¿™æ—¶ä½¿ç”¨ <code>safe_substitute() &lt;https://docs.python.org/2.7/library/string.html#string.Template.safe_substitute&gt;</code>_
                æ–¹æ³•å¯èƒ½æ›´é€‚åˆã€‚å¦‚æœæ•°æ®ä¸å®Œæ•´ï¼Œå®ƒå°±ä¸ä¼šæ”¹å˜å ä½ç¬¦::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; t = Template('Return the $item to $owner.')
&gt;&gt;&gt; d = dict(item='unladen swallow')
&gt;&gt;&gt; t.substitute(d)
Traceback (most recent call last):
 . . .
KeyError: 'owner'
&gt;&gt;&gt; t.safe_substitute(d)
'Return the unladen swallow to $owner.'
</code></pre>
            <p>æ¨¡æ¿å­ç±»å¯ä»¥æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰åˆ†éš”ç¬¦ã€‚ä¾‹å¦‚ï¼Œå›¾åƒæŸ¥çœ‹å™¨çš„æ‰¹é‡é‡å‘½åå·¥å…·å¯èƒ½é€‰æ‹©ä½¿ç”¨ç™¾åˆ†å·ä½œä¸ºå ä½ç¬¦ï¼Œåƒå½“å‰æ—¥æœŸï¼Œå›¾ç‰‡åºåˆ—å·æˆ–æ–‡ä»¶æ ¼å¼::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import time, os.path
&gt;&gt;&gt; photofiles = ['img_1074.jpg', 'img_1076.jpg', 'img_1077.jpg']
&gt;&gt;&gt; class BatchRename(Template):
...     delimiter = '%'
&gt;&gt;&gt; fmt = input('Enter rename style (%d-date %n-seqnum %f-format):  ')
Enter rename style (%d-date %n-seqnum %f-format):  Ashley_%n%f

&gt;&gt;&gt; t = BatchRename(fmt)
&gt;&gt;&gt; date = time.strftime('%d%b%y')
&gt;&gt;&gt; for i, filename in enumerate(photofiles):
...     base, ext = os.path.splitext(filename)
...     newname = t.substitute(d=date, n=i, f=ext)
...     print('{0} --&gt; {1}'.format(filename, newname))

img_1074.jpg --&gt; Ashley_0.jpg
img_1076.jpg --&gt; Ashley_1.jpg
img_1077.jpg --&gt; Ashley_2.jpg
</code></pre>
            <p>æ¨¡æ¿çš„å¦ä¸€ä¸ªåº”ç”¨æ˜¯æŠŠå¤šæ ·çš„è¾“å‡ºæ ¼å¼ç»†èŠ‚ä»ç¨‹åºé€»è¾‘ä¸­åˆ†ç±»å‡ºæ¥ã€‚è¿™ä¾¿ä½¿å¾— XML æ–‡ä»¶ï¼Œçº¯æ–‡æœ¬æŠ¥è¡¨å’Œ HTML WEB æŠ¥è¡¨å®šåˆ¶æ¨¡æ¿æˆä¸ºå¯èƒ½ã€‚</p>
            <div class="dsd_title_1"><a href="#top" id="3"><h2>3 ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®è®°å½•å¸ƒå±€</h2></a></div>
            <p><code>struct &lt;https://docs.python.org/2.7/library/struct.html#module-struct&gt;</code>_
                æ¨¡å—ä¸ºä½¿ç”¨å˜é•¿çš„äºŒè¿›åˆ¶è®°å½•æ ¼å¼æä¾›äº† <code>pack()
                    &lt;https://docs.python.org/2.7/library/struct.html#struct.pack&gt;</code>_ å’Œ <code>unpack() &lt;https://docs.python.org/2.7/library/struct.html#struct.unpack&gt;</code>_
                å‡½æ•°ã€‚ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†åœ¨ä¸ä½¿ç”¨ <code>zipfile
                    &lt;https://docs.python.org/2.7/library/zipfile.html#module-zipfile&gt;</code>_ æ¨¡å—çš„æƒ…å†µä¸‹å¦‚ä½•è¿­ä»£ä¸€ä¸ª ZIP
                æ–‡ä»¶çš„å¤´ä¿¡æ¯ã€‚å‹ç¼©ç  <code>"H"</code> å’Œ <code>"I"</code> åˆ†åˆ«è¡¨ç¤º2å’Œ4å­—èŠ‚æ— ç¬¦å·æ•°å­—ï¼Œ<code>"&lt;"</code> è¡¨æ˜å®ƒä»¬éƒ½æ˜¯æ ‡å‡†å¤§å°å¹¶ä¸”æŒ‰ç…§
                little-endian å­—èŠ‚æ’åº::</p>
            <pre class="prettyprint"><code>import struct

with open('myfile.zip', 'rb') as f:
   data = f.read()

start = 0
for i in range(3):                      # show the first 3 file headers
   start += 14
   fields = struct.unpack('&lt;IIIHH', data[start:start+16])
   crc32, comp_size, uncomp_size, filenamesize, extra_size = fields

   start += 16
   filename = data[start:start+filenamesize]
   start += filenamesize
   extra = data[start:start+extra_size]
   print filename, hex(crc32), comp_size, uncomp_size

   start += extra_size + comp_size     # skip to the next header
</code></pre>
            <div class="dsd_title_1"><a href="#top" id="4"><h2>4 å¤šçº¿ç¨‹</h2></a></div>
            <p>çº¿ç¨‹æ˜¯ä¸€ä¸ªåˆ†ç¦»æ— é¡ºåºä¾èµ–å…³ç³»ä»»åŠ¡çš„æŠ€æœ¯ã€‚åœ¨æŸäº›ä»»åŠ¡è¿è¡Œäºåå°çš„æ—¶å€™åº”ç”¨ç¨‹åºä¼šå˜å¾—è¿Ÿç¼“ï¼Œçº¿ç¨‹å¯ä»¥æå‡å…¶é€Ÿåº¦ã€‚ä¸€ä¸ªæœ‰å…³çš„ç”¨é€”æ˜¯åœ¨ I/O çš„åŒæ—¶å…¶å®ƒçº¿ç¨‹å¯ä»¥å¹¶è¡Œè®¡ç®—ã€‚ </p>
            <p>ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†é«˜çº§æ¨¡å— <code>threading
                &lt;https://docs.python.org/2.7/library/threading.html#module-threading&gt;</code>_ å¦‚ä½•åœ¨ä¸»ç¨‹åºè¿è¡Œçš„åŒæ—¶è¿è¡Œä»»åŠ¡::
            </p>
            <pre class="prettyprint"><code>import threading, zipfile

class AsyncZip(threading.Thread):
   def __init__(self, infile, outfile):
       threading.Thread.__init__(self)
       self.infile = infile
       self.outfile = outfile
   def run(self):
       f = zipfile.ZipFile(self.outfile, 'w', zipfile.ZIP_DEFLATED)
       f.write(self.infile)
       f.close()
       print 'Finished background zip of:', self.infile

background = AsyncZip('mydata.txt', 'myarchive.zip')
background.start()
print 'The main program continues to run in foreground.'

background.join()    # Wait for the background task to finish
print 'Main program waited until background was done.'
</code></pre>
            <p>å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºçš„ä¸»è¦æŒ‘æˆ˜æ˜¯åè°ƒçº¿ç¨‹ï¼Œè¯¸å¦‚çº¿ç¨‹é—´å…±äº«æ•°æ®æˆ–å…¶å®ƒèµ„æºã€‚ä¸ºäº†è¾¾åˆ°é‚£ä¸ªç›®çš„ï¼Œçº¿ç¨‹æ¨¡å—æä¾›äº†è®¸å¤šåŒæ­¥åŒ–çš„åŸç”Ÿæ”¯æŒï¼ŒåŒ…æ‹¬ï¼šé”ï¼Œäº‹ä»¶ï¼Œæ¡ä»¶å˜é‡å’Œä¿¡å·ç¯ã€‚</p>
            <p>å°½ç®¡è¿™äº›å·¥å…·å¾ˆå¼ºå¤§ï¼Œå¾®å°çš„è®¾è®¡é”™è¯¯ä¹Ÿå¯èƒ½é€ æˆéš¾ä»¥æŒ½å›çš„æ•…éšœã€‚å› æ­¤ï¼Œä»»åŠ¡åè°ƒçš„é¦–é€‰æ–¹æ³•æ˜¯æŠŠå¯¹ä¸€ä¸ªèµ„æºçš„æ‰€æœ‰è®¿é—®é›†ä¸­åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­ï¼Œç„¶åä½¿ç”¨ <code>Queue &lt;https://docs.python.org/2.7/library/queue.html#module-Queue&gt;</code>_
                æ¨¡å—ç”¨é‚£ä¸ªçº¿ç¨‹æœåŠ¡å…¶ä»–çº¿ç¨‹çš„è¯·æ±‚ã€‚ä¸ºå†…éƒ¨çº¿ç¨‹é€šä¿¡å’Œåè°ƒè€Œä½¿ç”¨ <code>Queue.Queue &lt;https://docs.python.org/2.7/library/queue.html#Queue.Queue&gt;</code>_
                å¯¹è±¡çš„åº”ç”¨ç¨‹åºæ›´æ˜“äºè®¾è®¡ï¼Œæ›´å¯è¯»ï¼Œå¹¶ä¸”æ›´å¯é ã€‚</p>
            <div class="dsd_title_1"><a href="#top" id="5"><h2>5 æ—¥å¿—</h2></a></div>
            <p><code>logging &lt;https://docs.python.org/2.7/library/logging.html#module-logging&gt;</code>_
                æ¨¡å—æä¾›äº†å®Œæ•´å’Œçµæ´»çš„æ—¥å¿—ç³»ç»Ÿã€‚å®ƒæœ€ç®€å•çš„ç”¨æ³•æ˜¯è®°å½•ä¿¡æ¯å¹¶å‘é€åˆ°ä¸€ä¸ªæ–‡ä»¶æˆ– <code>sys.stderr</code>::</p>
            <pre class="prettyprint"><code>import logging
logging.debug('Debugging information')
logging.info('Informational message')
logging.warning('Warning:config file %s not found', 'server.conf')
logging.error('Error occurred')
logging.critical('Critical error -- shutting down')
</code></pre>
            <p>è¾“å‡ºå¦‚ä¸‹::</p>
            <pre class="prettyprint"><code>WARNING:root:Warning:config file server.conf not found
ERROR:root:Error occurred
CRITICAL:root:Critical error -- shutting down
</code></pre>
            <p>é»˜è®¤æƒ…å†µä¸‹æ•è·ä¿¡æ¯å’Œè°ƒè¯•æ¶ˆæ¯å¹¶å°†è¾“å‡ºå‘é€åˆ°æ ‡å‡†é”™è¯¯æµã€‚å…¶å®ƒå¯é€‰çš„è·¯ç”±ä¿¡æ¯æ–¹å¼é€šè¿‡ emailï¼Œæ•°æ®æŠ¥æ–‡ï¼Œsocket æˆ–è€… HTTP
                Serverã€‚åŸºäºæ¶ˆæ¯å±æ€§ï¼Œæ–°çš„è¿‡æ»¤å™¨å¯ä»¥é€‰æ‹©ä¸åŒçš„è·¯ç”±ï¼š:const:<code>DEBUG</code>ï¼Œ:const:<code>INFO</code>ï¼Œ:const:<code>WARNING</code>ï¼Œ:const:<code>ERROR</code>
                å’Œ :const:<code>CRITICAL</code> ã€‚ </p>
            <p>æ—¥å¿—ç³»ç»Ÿå¯ä»¥ç›´æ¥åœ¨ Python ä»£ç ä¸­å®šåˆ¶ï¼Œä¹Ÿå¯ä»¥ä¸ç»è¿‡åº”ç”¨ç¨‹åºç›´æ¥åœ¨ä¸€ä¸ªç”¨æˆ·å¯ç¼–è¾‘çš„é…ç½®æ–‡ä»¶ä¸­åŠ è½½ã€‚</p>
            <div class="dsd_title_1"><a href="#top" id="6"><h2>6 å¼±å¼•ç”¨</h2></a></div>
            <p>Python è‡ªåŠ¨è¿›è¡Œå†…å­˜ç®¡ç†(å¯¹å¤§å¤šæ•°çš„å¯¹è±¡è¿›è¡Œå¼•ç”¨è®¡æ•°å’Œåƒåœ¾å›æ”¶ <code>garbage collection &lt;https://docs.python.org/2.7/glossary.html#term-garbage-collection&gt;</code>_
                ä»¥å¾ªç¯åˆ©ç”¨)åœ¨æœ€åä¸€ä¸ªå¼•ç”¨æ¶ˆå¤±åï¼Œå†…å­˜ä¼šå¾ˆå¿«é‡Šæ”¾ã€‚</p>
            <p>è¿™ä¸ªå·¥ä½œæ–¹å¼å¯¹å¤§å¤šæ•°åº”ç”¨ç¨‹åºå·¥ä½œè‰¯å¥½ï¼Œä½†æ˜¯å¶å°”ä¼šéœ€è¦è·Ÿè¸ªå¯¹è±¡æ¥åšä¸€äº›äº‹ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä»…ä»…ä¸ºè·Ÿè¸ªå®ƒä»¬åˆ›å»ºå¼•ç”¨ä¹Ÿä¼šä½¿å…¶é•¿æœŸå­˜åœ¨ã€‚<code>weakref &lt;https://docs.python.org/2.7/library/weakref.html#module-weakref&gt;</code>_
                æ¨¡å—æä¾›äº†ä¸ç”¨åˆ›å»ºå¼•ç”¨çš„è·Ÿè¸ªå¯¹è±¡å·¥å…·ï¼Œä¸€æ—¦å¯¹è±¡ä¸å†å­˜åœ¨ï¼Œå®ƒè‡ªåŠ¨ä»å¼±å¼•ç”¨è¡¨ä¸Šåˆ é™¤å¹¶è§¦å‘å›è°ƒã€‚å…¸å‹çš„åº”ç”¨åŒ…æ‹¬æ•è·éš¾ä»¥æ„é€ çš„å¯¹è±¡::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import weakref, gc
&gt;&gt;&gt; class A:
...     def __init__(self, value):
...             self.value = value
...     def __repr__(self):
...             return str(self.value)
...
&gt;&gt;&gt; a = A(10)                   # create a reference
&gt;&gt;&gt; d = weakref.WeakValueDictionary()
&gt;&gt;&gt; d['primary'] = a            # does not create a reference
&gt;&gt;&gt; d['primary']                # fetch the object if it is still alive
10
&gt;&gt;&gt; del a                       # remove the one reference
&gt;&gt;&gt; gc.collect()                # run garbage collection right away
0
&gt;&gt;&gt; d['primary']                # entry was automatically removed
Traceback (most recent call last):
 File "&lt;stdin&gt;", line 1, in &lt;module&gt;
   d['primary']                # entry was automatically removed
 File "C:/python33/lib/weakref.py", line 46, in __getitem__
   o = self.data[key]()
KeyError: 'primary'
</code></pre>
            <div class="dsd_title_1"><a href="#top" id="7"><h2>7 åˆ—è¡¨å·¥å…·</h2></a></div>
            <p>å¾ˆå¤šæ•°æ®ç»“æ„å¯èƒ½ä¼šç”¨åˆ°å†…ç½®åˆ—è¡¨ç±»å‹ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å¯èƒ½éœ€è¦ä¸åŒæ€§èƒ½ä»£ä»·çš„å®ç°ã€‚ </p>
            <p><code>array &lt;https://docs.python.org/2.7/library/array.html#module-array&gt;</code>_ æ¨¡å—æä¾›äº†ä¸€ä¸ªç±»ä¼¼åˆ—è¡¨çš„
                <code>array() &lt;https://docs.python.org/2.7/library/array.html#array.array&gt;</code>_
                å¯¹è±¡ï¼Œå®ƒä»…ä»…æ˜¯å­˜å‚¨æ•°æ®ï¼Œæ›´ä¸ºç´§å‡‘ã€‚ä»¥ä¸‹çš„ç¤ºä¾‹æ¼”ç¤ºäº†ä¸€ä¸ªå­˜å‚¨åŒå­—èŠ‚æ— ç¬¦å·æ•´æ•°çš„æ•°ç»„(ç±»å‹ç¼–ç  <code>"H"</code> )è€Œéå­˜å‚¨ 16 å­—èŠ‚ Python æ•´æ•°å¯¹è±¡çš„æ™®é€šæ­£è§„åˆ—è¡¨::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; from array import array
&gt;&gt;&gt; a = array('H', [4000, 10, 700, 22222])
&gt;&gt;&gt; sum(a)
26932
&gt;&gt;&gt; a[1:3]
array('H', [10, 700])
</code></pre>
            <p><code>collections &lt;https://docs.python.org/2.7/library/collections.html#module-collections&gt;</code>_
                æ¨¡å—æä¾›äº†ç±»ä¼¼åˆ—è¡¨çš„ <code>deque()
                    &lt;https://docs.python.org/2.7/library/collections.html#collections.deque&gt;</code>_
                å¯¹è±¡ï¼Œå®ƒä»å·¦è¾¹æ·»åŠ (append)å’Œå¼¹å‡º(pop)æ›´å¿«ï¼Œä½†æ˜¯åœ¨å†…éƒ¨æŸ¥è¯¢æ›´æ…¢ã€‚è¿™äº›å¯¹è±¡æ›´é€‚ç”¨äºé˜Ÿåˆ—å®ç°å’Œå¹¿åº¦ä¼˜å…ˆçš„æ ‘æœç´¢::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; from collections import deque
&gt;&gt;&gt; d = deque(["task1", "task2", "task3"])
&gt;&gt;&gt; d.append("task4")
&gt;&gt;&gt; print "Handling", d.popleft()
Handling task1

unsearched = deque([starting_node])
def breadth_first_search(unsearched):
   node = unsearched.popleft()
   for m in gen_moves(node):
       if is_goal(m):
           return m
       unsearched.append(m)
</code></pre>
            <p>é™¤äº†é“¾è¡¨çš„æ›¿ä»£å®ç°ï¼Œè¯¥åº“è¿˜æä¾›äº† <code>bisect
                &lt;https://docs.python.org/2.7/library/bisect.html#module-bisect&gt;</code>_ è¿™æ ·çš„æ¨¡å—ä»¥æ“ä½œå­˜å‚¨é“¾è¡¨::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; import bisect
&gt;&gt;&gt; scores = [(100, 'perl'), (200, 'tcl'), (400, 'lua'), (500, 'python')]
&gt;&gt;&gt; bisect.insort(scores, (300, 'ruby'))
&gt;&gt;&gt; scores
[(100, 'perl'), (200, 'tcl'), (300, 'ruby'), (400, 'lua'), (500, 'python')]
</code></pre>
            <p><code>heapq &lt;https://docs.python.org/2.7/library/heapq.html#module-heapq&gt;</code>_
                æä¾›äº†åŸºäºæ­£è§„é“¾è¡¨çš„å †å®ç°ã€‚æœ€å°çš„å€¼æ€»æ˜¯ä¿æŒåœ¨ 0 ç‚¹ã€‚è¿™åœ¨å¸Œæœ›å¾ªç¯è®¿é—®æœ€å°å…ƒç´ ä½†æ˜¯ä¸æƒ³æ‰§è¡Œå®Œæ•´å †æ’åºçš„æ—¶å€™éå¸¸æœ‰ç”¨::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; from heapq import heapify, heappop, heappush
&gt;&gt;&gt; data = [1, 3, 5, 7, 9, 2, 4, 6, 8, 0]
&gt;&gt;&gt; heapify(data)                      # rearrange the list into heap order
&gt;&gt;&gt; heappush(data, -5)                 # add a new entry
&gt;&gt;&gt; [heappop(data) for i in range(3)]  # fetch the three smallest entries
[-5, 0, 1]
</code></pre>
            <div class="dsd_title_1"><a href="#top" id="8"><h2>8 åè¿›åˆ¶æµ®ç‚¹æ•°ç®—æ³•</h2></a></div>
            <p><code>decimal &lt;https://docs.python.org/2.7/library/decimal.html#module-decimal&gt;</code>_ æ¨¡å—æä¾›äº†ä¸€ä¸ª
                <code>Decimal &lt;https://docs.python.org/2.7/library/decimal.html#decimal.Decimal&gt;</code>_
                æ•°æ®ç±»å‹ç”¨äºæµ®ç‚¹æ•°è®¡ç®—ã€‚ç›¸æ¯”å†…ç½®çš„äºŒè¿›åˆ¶æµ®ç‚¹æ•°å®ç° <code>float
                    &lt;https://docs.python.org/2.7/library/functions.html#float&gt;</code>_ï¼Œè¿™ä¸ªç±»å‹æœ‰åŠ©äºï¼š</p>
            <ul>
                <li><p>é‡‘èåº”ç”¨å’Œå…¶å®ƒéœ€è¦ç²¾ç¡®åè¿›åˆ¶è¡¨è¾¾çš„åœºåˆï¼Œ</p></li>
                <li><p>æ§åˆ¶ç²¾åº¦ï¼Œ</p></li>
                <li><p>æ§åˆ¶èˆå…¥ä»¥é€‚åº”æ³•å¾‹æˆ–è€…è§„å®šè¦æ±‚ï¼Œ</p></li>
                <li><p>ç¡®ä¿åè¿›åˆ¶æ•°ä½ç²¾åº¦ï¼Œ</p>
                    <p>æˆ–è€…</p></li>
                <li><p>ç”¨æˆ·å¸Œæœ›è®¡ç®—ç»“æœä¸æ‰‹ç®—ç›¸ç¬¦çš„åœºåˆã€‚</p></li>
            </ul>
            <p>ä¾‹å¦‚ï¼Œè®¡ç®— 70 åˆ†ç”µè¯è´¹çš„ 5% ç¨è®¡ç®—ï¼Œåè¿›åˆ¶æµ®ç‚¹æ•°å’ŒäºŒè¿›åˆ¶æµ®ç‚¹æ•°è®¡ç®—ç»“æœçš„å·®åˆ«å¦‚ä¸‹ã€‚å¦‚æœåœ¨åˆ†å€¼ä¸Šèˆå…¥ï¼Œè¿™ä¸ªå·®åˆ«å°±å¾ˆé‡è¦äº†::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; from decimal import *
&gt;&gt;&gt; round(Decimal('0.70') * Decimal('1.05'), 2)
Decimal('0.74')
&gt;&gt;&gt; round(.70 * 1.05, 2)
0.73
</code></pre>
            <p><code>Decimal &lt;https://docs.python.org/2.7/library/decimal.html#decimal.Decimal&gt;</code>_ çš„ç»“æœæ€»æ˜¯ä¿æœ‰ç»“å°¾çš„
                0ï¼Œè‡ªåŠ¨ä»ä¸¤ä½ç²¾åº¦å»¶ä¼¸åˆ°4ä½ã€‚Decimal é‡ç°äº†æ‰‹å·¥çš„æ•°å­¦è¿ç®—ï¼Œè¿™å°±ç¡®ä¿äº†äºŒè¿›åˆ¶æµ®ç‚¹æ•°æ— æ³•ç²¾ç¡®ä¿æœ‰çš„æ•°æ®ç²¾åº¦ã€‚</p>
            <p>é«˜ç²¾åº¦ä½¿ <code>Decimal &lt;https://docs.python.org/2.7/library/decimal.html#decimal.Decimal&gt;</code>_
                å¯ä»¥æ‰§è¡ŒäºŒè¿›åˆ¶æµ®ç‚¹æ•°æ— æ³•è¿›è¡Œçš„æ¨¡è¿ç®—å’Œç­‰å€¼æµ‹è¯•::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; Decimal('1.00') % Decimal('.10')
Decimal('0.00')
&gt;&gt;&gt; 1.00 % 0.10
0.09999999999999995

&gt;&gt;&gt; sum([Decimal('0.1')]*10) == Decimal('1.0')
True
&gt;&gt;&gt; sum([0.1]*10) == 1.0
False
</code></pre>
            <p><code>decimal &lt;https://docs.python.org/2.7/library/decimal.html#module-decimal&gt;</code>_
                æä¾›äº†å¿…é¡»çš„é«˜ç²¾åº¦ç®—æ³•::</p>
            <pre class="prettyprint"><code>&gt;&gt;&gt; getcontext().prec = 36
&gt;&gt;&gt; Decimal(1) / Decimal(7)
Decimal('0.142857142857142857142857142857142857')
</code></pre>
            <span>è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥: <a href="http://dashidan.com/article/python/index.html">http://dashidan.com/article/python/index.html</a>
                </span>
        </div>
    </div>

    <div id="xs_content"></div>
    <div class="text-center">
        <div>
            <a href="http://dashidan.com/article/python/doc27/12.html">ğŸ“–
                ä¸‹ä¸€ç¯‡: æ¥ä¸‹æ¥</a>
        </div>
    </div>
</div>

<div style="display:none;">
    <script src="https://s19.cnzz.com/z_stat.php?id=1264355070&web_id=1264355070" language="JavaScript"></script>
</div>

<script src="http://dashidan.com/js/jquery-3.2.1.min.js"></script>
<script src="http://dashidan.com/js/vendor/modernizr-custom.js"></script>
<script src="http://dashidan.com/js/bootstrap.js"></script>
<script src="http://dashidan.com/js/google-code-prettify/run_prettify.js"></script>
<script src="http://dashidan.com/js/main.js"></script>
</body>
</html>
