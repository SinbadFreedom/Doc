nginx支持php解析
===

nginx配置表中带有php文件解析的配置, 默认情况下是注销掉的.

打开对应的注释即可.

注释中有2中支持php的方式, 通过php-cgi和php-fpm.

1. 安装fpm-php
---

php-fpm是php-cli的进程管理程序, 当一个进程关闭后, 会自动启动一个新的线程.

非常强大, 这个是比装的.

以ubuntu为例介绍. 其他操作系统类似.
国内部分镜像源是php5-fpm, 阿里云上的为php7-fpm.

安装方式

```
apt-get install php5-fpm
```

或者

```
apt-get install php7-fpm
```

2. 如何区分采用php-cgi和php-fpm
---

安装完成后, 搜索一下是否有`php5-fpm.sock`或者`php7-fpm.sock`.

```
find / -name php5-fpm
```

或者

```
find / -name php7-fpm
```

如果有这个文件就采用php-fpm的模式, 没有的话就采用php-cgi模式.

3. 修改nginx配置文件
---

默认情况下修改nginx安装目录中的`site-enable/default`文件.

* 支持php-cgi模式

```
location ~ \.php$ {
	fastcgi_split_path_info ^(.+\.php)(/.+)$;
#	# NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini
#
#	# With php5-cgi alone:
	fastcgi_pass 127.0.0.1:9000;
#	# With php5-fpm:
#	fastcgi_pass unix:/var/run/php5-fpm.sock;
#	fastcgi_index index.php;
#	include fastcgi_params;
}
```
	
* 支持php-fpm模式

```
location ~ \.php$ {
	fastcgi_split_path_info ^(.+\.php)(/.+)$;
#	# NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini
#
#	# With php5-cgi alone:
#	fastcgi_pass 127.0.0.1:9000;
#	# With php5-fpm:
#	fastcgi_pass unix:/var/run/php5-fpm.sock;
	fastcgi_index index.php;
	include fastcgi_params;
}
```